- hosts: all
  become: yes
  become_user: root
  pre_tasks:
    - name: /data/ directories
      file:
        path: "{{ item }}"
        state: directory
        mode: u=rwx,g=rwx,o=rx
      with_items:
        - /data
        - /data/work
        - /data/opt
        - /data/services
        - /data/services/web
    - name: /data/services/web/tomcat
      file:
        path: /data/services/web/tomcat
        state: directory
        owner: vagrant
        group: vagrant
        mode: u=rwx,g=rwx,o=rx
  roles:
    - role: java
      java_download_path: /data/work
      java_runtime_path: /data/opt
      java_results_var: jdks
      java_runtimes:
        - version: 8u112
          version_build: 15
          arch: x64
          type: jdk
          checksum: md5:de9b7a90f0f5a13cfcaa3b01451d0337
          key: jdk-8u112-x64
    - role: tomcat7
      tomcat7_version: 7.0.73
      tomcat7_checksum: md5:ca9a50ad51d79282f9ca397514c755d7
      tomcat7_dest: /data/opt/tomcat-7.0.73
      tomcat7_default_user: vagrant
      tomcat7_default_java_home: "{{ jdks['jdk-8u112-x64'].path }}"
      tomcat7_catalina_bases:
        - name: tomcat
          path: /data/services/web/tomcat
